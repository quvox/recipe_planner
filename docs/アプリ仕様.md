# 献立提案 PWA 仕様まとめ（更新版）

## 1. アプリ概要

- **目的**
    - 入力した食材・テーマ・人数構成を基に、AI が _時短料理_ の献立案を 3 件生成。
    - 過去に生成した献立を保存し、検索・再閲覧・削除できる。
    - **PWA として iPhone などにインストール可能 ＆ GitHub Pages でホスティング**。

## 2. 主要機能

### ホーム
- **献立を考える**
  - 「献立を考える」ボタンのみ表示
- **過去の献立を探す**
  - 「過去の献立を探す」ボタンのみ表示

### 献立生成
- **入力フォーム**
  - **食材ボックス**: 追加・削除可（最低 1 個）
  - **テーマ**: `春` / `夏` / `秋` / `冬` / `がっつり` / `あっさり`
  - **人数構成**: `夫婦2人` / `夫婦＋中高生3人` / `中高生3人`
- **提案処理**
  - 必須項目をバリデーション
  - 問題なければプロンプト生成 → AI へリクエスト
  - 未入力があればエラー表示
- **表示**
  - AI 返答はカード形式で 3 件表示
  - カードごとに保存ボタンを配置する。保存しなければ過去献立には登録されない
  - 重複して同じものが保存されないようにする
  - 各カードは「見出し」のみ一覧に表示し、タップでレシピ詳細を展開

### 過去献立
- **一覧表示**
  - 見出しのみリスト表示（新しい順）
  - タップで詳細展開
- **採用不採用チェック**
  - その献立を採用した場合には採用チェックボックスにチェックをいれる
  - その献立は使えないと判断した場合は、不採用チェックボックスにチェックをいれる
  - 採用・不採用はオンオフできること。つまり、何も選択していない状態、採用が選択されている状態、不採用が選択されている状態のいずれかになること。
- **操作**
  - 個別削除（確認ダイアログあり）

### データ管理
- **永続化**
  - 保存項目: `献立詳細`, `作成日`, `入力食材リスト`
- **エクスポート／インポート**
  - JSON 形式で一括エクスポート／インポート

### 設定
- **API キー管理**
  - OpenAI / Claude の API キーを UI から登録・更新

## 3. 画面遷移イメージ

```
[ホーム]
 ├─▶ 献立を考える
 │     ├─ 入力フォーム
 │     ├─ 提案結果（カード3件）
 │     └─ 保存 → ホーム
 └─▶ 過去の献立を探す
       ├─ 一覧（見出し）
       ├─ 詳細表示
       └─ 削除
```

## 4. AI プロンプト生成要件

- **目的**:

    - 指定食材・テーマ・人数構成を使い、30 分以内で作れる家庭向け _時短料理_ の献立を 3 案生成させる。

- **出力フォーマット指示例**（AI へ送信）

  ```text
  以下の JSON 配列で回答してください:
  [
    {
      "title": "献立名",
      "description": "概要",
      "ingredients": ["食材A", "食材B", ...],
      "steps": ["手順1", "手順2", ...],
      "time": "調理目安時間(分)"
    },
    ...
  ]
  ```

- **バリデーション**

    - フロント側で `JSON.parse` に成功するか確認。失敗時は再リクエスト。

## 5. 技術スタック & アーキテクチャ概要

### フロント
- React + Vite
- PWA (Service Worker, Manifest)
- オフライン時でも過去献立閲覧可

### 状態管理
- Zustand / Redux Toolkit
- API キー・献立履歴を保持

### ストレージ
- IndexedDB (idb ラッパ)
- 献立履歴と設定をローカル保存

### サーバ通信
- fetch / axios
- AI API 呼び出し

### スタイル
- Tailwind CSS など
- モバイル優先デザイン

### **デプロイ**
- **GitHub Pages + GitHub Actions**
- `gh-pages` ブランチへ CI/CD。HTTPS・Service Worker 対応済み

## 6. データモデル（IndexedDB 例）

```ts
interface MenuRecord {
  id: string;            // UUID
  title: string;
  description: string;
  ingredients: string[];
  steps: string[];
  time: number;          // 分
  theme: string;
  peoplePattern: string; // 人数構成
  createdAt: string;     // ISO8601
  inputIngredients: string[];
}
```

## 7. 例外・エラーハンドリング

- 必須入力漏れ → フォーム下に赤字で表示。
- AI 返答フォーマット不備 → リトライ提案。
- ストレージ容量不足 → 警告モーダル表示。
- オフライン時の API 呼び出し → 「ネットワーク接続を確認してください」。

## 8. 今後の拡張アイデア

- 食材バーコード読取／音声入力対応
- 栄養バランス自動計算
- 献立周期の自動提案（同じ料理が続かないよう提案）
- 共有リンク生成（家族とメニュー共有）  